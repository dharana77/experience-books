
#  4.1 ~. 4.6 마이크로 서비스와 도커

- 도커


- 4.1 컨테이너 또는 가상머신?

- 4.2 도커란?

- 4.3 Dockerfile

- 4.4 도커 컴포즈

- 4.5 마이크로 서비스와 도커 통합하기

- 4.6 요약


## point
- 컨테이너 중요성
- 컨테이너를 마이크로서비스 아키텍처에 적용하는 방법
- VM과 컨테이너의 차이점 이해
- 도커 및 주요 컴포넌트 사용
- 도커와 마이크로서비스 통합



## 이식성 문제 - 마이크로서비스를 어떻게 다른 기술환경에 실행할 수 있을까?

이식성이란 소프트웨어를 다른 환경에 사용하거나 이동할 수 있는 능력이라 정의

보통 VM과 도커의 차이점을 많이 물어보기도 하는데
가상머신은 물리 머신을 완벽히 에뮬레이션하는 하이퍼바이저에 기반을 두며
하이퍼바이저는 시스템 메모리, 프로세스 코어, 디스크 스토리지 및 네트워크, PCI 에드온 등 다른 기술 자원의 요구량을 할당하는 역할을 함.

반면 컨테이너는 격리된 독립 환경에서 애플리케이션 구성요소와 함께 애플리케이션을 실행할 수 있는 가상 운영체제가 포함된 패키지


### 주요 차이점은 컨테이너는 자원 할당을 위한 게스트 OS나 하이퍼바이저 대신 컨테이너 엔진을 사용한다는 것

VM의 경우
프로세서는 서로 다른 VM 간에 공유될 수 있음
VM의 디스크 스페이스는 필요한 만큼 사용할 수 있도록 설정할 수 있음
디스크 최대 크기를 정의할 수 있지만 시스템에서 활발히 사용되는 스페이스만  사용함
예약 메모리는 총 메모리 이며 VM간 공유되지 않음


컨테이너는 기본 OS를 재사용할 수 있어
완전한 OS가 필요하지 않기 때무에 물리 머신이 지원해야 하는 부하는 물론 사용된 스토리지 스페이스와 애플리케이션 시작 시간도 줄어듬
따라서 컨테이너는 VM보다 훨씬 가벼움

이에 따라 다양한 운영체제를 처리하고 단일 서버에서 어플리케이션을 관리하고, OS 기능이 필요한 어플리케이션을 실행한다고 한다면 VMd이 나은 솔루션임

가볍고 빠르기 때문에 컨테이너 기반의 아키텍처가 활성화 되었다고 생각함

컨테이너 사용시 얻게 될 이점은
개발 및 구현이 용이하고 이식성이 높음
완전 격리된 예측 가능한 환경을 생성해줌
VM보다 더 빠르게 시작 중지 가능해 클라우드 네이티브가 가능
확장 가능하고 자원 활용을 최적화하는데 능동적으로 스케줄링 하고 관리할 수 있어 컨테이너 내부 실행 되는 어플리케이션의 성능과 유지보수성을 높임
최소 서버로 가능한 많은 애플리케이션을 실행할 수 있음



## 도커란
컨테이너 - 애플리케이션이 실행하는데 필요한 모든 것을 제공하는 논리적 패키징 매커니즘을 의미


## 도커엔진이란
전체 도커 시스템의 핵심부로
클라이언트-서버 아키텍처를 따르는 애플리케이션으로서 호스트 머신에 설치되며 서버, REST API, 명령줄 인터페이스라는 세가지 중요 구성요소를 포함함
Screenshot 2024-10-10 at 8.55.07 PM.png


도커엔진은 다음 구성요소로 이루어져 있음

- 도커 데몬:
  - 도커 이미지를 생성하고 관리하는 dockerd라는 서버
  - REST API가 데몬에 명령을 보내고 CLI 클라이언트가 도커 명령을 입력함
- 도커 클라이언트:
  - 도커 사용자는 클라이언트로 도커와 상호작용함
  - 도커 명령이 실행되면 클라이언트는 데몬에 명령을 보내는 역할을 수행함
- 도커 레지스트리:
  - 도커 이미지가 저장되는 곳
  - 이 레지스트리는 공개 또는 사설 레지스트리 일 수 있음
  - 도커 허브는 기본 공개 레지스트리이고 전용 사설 레지스트리도 만들 수 있음
- 도커 이미지:
  - 도커 컨테이너를 생성하는 몇가지 명령이 포함된 읽기 전용 템플릿
  - 이미지는 도커 허브에서 가져올 수 있고 그대로 사용하거나 추가 명령으로 수정할 수 있음
  - 또한 dockerfile을 사용해서 새로운 이미지를 생성할 수도 있음
- 도커 컨테이너:
  - docker run 명령이 생성되고 수행되면 도커 이미지는 컨테이너를 생성함
  - 애플리케이션과 주변환경은 이 컨테이너에서 실행됨
  - 도커 컨테이너를 시작/중지/삭제하려면 도커 API나 CLI를 사용할 수 있음
- 도커 볼륨:
  - 도커 볼룸은 도커가 생성하고 컨테이너가 사용한 데이터를 저장하는데 적합한 메커니즘임
  - 도커 API나 CLI로 관리됨
- 도커 네트워크:
  - 도커 네트워크를 사용한 컨테이너를 가능한 많은 네트워크에 연결할 수 있음
  - 네트워크를 격리된 컨테이너의 통신 수단으로 생각할 수 있으며 도커에는 bridge, host, overlay, none, Maclan의 다섯가지 네트워크 드라이버 타입이 있음Screenshot 2024-10-10 at 9.00.35 PM.png




### 4.3 dockerfiles

도커 파일은 도커 클라이언트가 이미지를 생성하고 준비하기 위해 호출하는데 필요한 지시어와 명령어들이 포함된 텍스트 파일임

이는 이미지 생성을 자동화함

### 4.4
- 도커 컴포즈:
도커 컴포즈는  서비스 설계와 구축이 용이한 스크립트를 작성하여
도커를 더 쉽게 사용하게 함
도커 컴포즈를 사용하면 여러 컨테이너를 하나의 서비스로 실행하거나 다른 컨테이너를 동시에 생성할 수 있음


### 4.5
마이크로서비스와 도커 통합하기

도커레이어
멀티레이어
도커컴포즈
스프링으로 도커 실행하기 실습

